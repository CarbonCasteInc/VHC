# Sprint 3.5: UI/UX Refinement

**Context:** Post-Sprint 3 polish pass before Sprint 4
**Goal:** Refine and harden the current HERMES Messaging + Forum UI/UX based on real usage feedback
**Status:** [ ] In Progress
**Predecessor:** Sprint 3 â€” âœ… COMPLETE (Dec 6, 2025)

> **Rationale:** Sprint 3 delivered working functionality. Before adding more features (Docs, Bridge), we need to refine the UX to be intuitive and polished. This sprint is driven by hands-on testing and user feedback.

---

## 1. Guiding Principles

1. **Polish Over Features:** No new functionality â€” only refinement of existing flows.
2. **User-Driven:** Issues identified through real usage testing.
3. **Light Touch:** Minimal code changes with maximum UX impact.
4. **No Regressions:** All existing tests must continue to pass.

---

## 2. Forum UI Refinements

### 2.1 Comment/Counterpoint Display Consolidation

**Issue:** Comments with counterpoints are displayed twice:
1. As a linear comment thread (Comment â†’ Reply/Counterpoint)
2. As an Argument/Counterpoint card below

**Current Behavior (Problematic):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Comment: "OK, let's see"                              [â–² 2 â–¼]â”‚
â”‚ â””â”€ Reply: "SIr, Sir!"                                 [â–² 0 â–¼]â”‚
â”‚    [Reply] [Counterpoint]                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“ DUPLICATED â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ARGUMENT                    â”‚ COUNTERPOINTS                 â”‚
â”‚ "OK, let's see"             â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                             â”‚ â”‚ SIr, Sir!                â”‚ â”‚
â”‚                             â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Expected Behavior:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ARGUMENT                    â”‚ COUNTERPOINTS           [â–² 2 â–¼]â”‚
â”‚ "OK, let's see"             â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                             â”‚ â”‚ SIr, Sir!          [â–² 0 â–¼]â”‚  â”‚
â”‚                             â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚ [Click to expand thread...]                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

When expanded:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ARGUMENT                    â”‚ COUNTERPOINTS           [â–² 2 â–¼]â”‚
â”‚ "OK, let's see"             â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                             â”‚ â”‚ SIr, Sir!          [â–² 0 â–¼]â”‚  â”‚
â”‚                             â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Thread (3 replies)                                    [Hide] â”‚
â”‚ â”œâ”€ "First reply..."                                         â”‚
â”‚ â”œâ”€ "Another thought..."                                     â”‚
â”‚ â””â”€ "Final point"                                            â”‚
â”‚                                                             â”‚
â”‚ [Reply] [Counterpoint]                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Requirements:**
- [ ] When a comment has counterpoints, render ONLY the Argument/Counterpoint card view
- [ ] Do NOT render the same comment in the linear thread above the card
- [ ] Add "Click to expand" affordance on the card
- [ ] When expanded, show nested replies in a collapsible section
- [ ] Keep voting controls on both the argument and counterpoint pills
- [ ] Reply/Counterpoint buttons appear in expanded view only

**Files to Modify:**
- `apps/web-pwa/src/components/hermes/ThreadView.tsx`
- `apps/web-pwa/src/components/hermes/CommentNode.tsx`
- `apps/web-pwa/src/components/hermes/CounterpointPanel.tsx`

---

### 2.2 VENN â†’ Forum Transition (Article Discussion)

**Vision:** One-step animated transition from article/summary view to its discussion thread.

**Animation Specification:**
- **Type:** 3D card flip
- **What flips:** ONLY the Summary + Bias Table section
- **What stays:** Headline/Topic remains visible at top (anchor point)
- **Reveals:** Forum thread on the "back" of the flipped card

**Expected Behavior:**
```
VENN Article View                              
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Headline: "Climate Bill Passes Senate"       â”‚ â† STAYS FIXED
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚   Summary: "The Senate voted..."         â”‚ â”‚
â”‚ â”‚                                          â”‚ â”‚ â† THIS SECTION
â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚    FLIPS
â”‚ â”‚   â”‚ BIAS TABLE                         â”‚ â”‚ â”‚
â”‚ â”‚   â”‚ Frame        â”‚ Reframe             â”‚ â”‚ â”‚
â”‚ â”‚   â”‚ [+][-]       â”‚ [+][-]              â”‚ â”‚ â”‚
â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚   [Discuss in Forum] â† Click to flip     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â†“ 3D Card Flip Animation â†“

Forum Thread View (after flip)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Headline: "Climate Bill Passes Senate"       â”‚ â† SAME HEADLINE
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚   Discussion Thread                      â”‚ â”‚
â”‚ â”‚                                          â”‚ â”‚ â† "BACK" OF
â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚    THE CARD
â”‚ â”‚   â”‚ Comment: "I agree with..."         â”‚ â”‚ â”‚
â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚   â”‚ Comment: "But consider..."         â”‚ â”‚ â”‚
â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚   [â† Back to Analysis] â† Click to flip   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**No Existing Thread:**
When flipping from an article with no discussion yet, show empty thread with "Start the conversation" prompt:

```
Forum Thread View (empty state)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Headline: "Climate Bill Passes Senate"       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚   ğŸ’¬ No discussion yet                   â”‚ â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚   Be the first to share your thoughts   â”‚ â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚   â”‚ Start the conversation...          â”‚ â”‚ â”‚
â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚   [Post]                                 â”‚ â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚   [â† Back to Analysis]                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Requirements:**
- [ ] **3D card flip animation** â€” CSS perspective transform on the content area
- [ ] **Headline anchored** â€” Topic/headline stays fixed at top during flip
- [ ] **Summary/Bias on "front"** â€” Analysis content is the front face
- [ ] **Thread on "back"** â€” Forum discussion is the back face
- [ ] **Flip trigger** â€” "Discuss in Forum" button initiates flip
- [ ] **Reverse flip** â€” "Back to Analysis" button flips back
- [ ] **Empty state** â€” No thread yet â†’ show "Start the conversation" prompt with inline composer
- [ ] **Deep link support** â€” Direct URL to thread shows thread side directly

**Files to Modify:**
- `apps/web-pwa/src/components/venn/AnalysisView.tsx`
- New: `FlippableCard.tsx` wrapper component with CSS 3D transforms
- `apps/web-pwa/src/components/hermes/ThreadView.tsx` â€” Empty state UI
- `apps/web-pwa/src/routes/hermes/forum/$threadId.tsx`

---

### 2.3 Nested Comment Zoom/Focus Pattern

**Vision:** Comments are "zoomable" â€” clicking into a comment fills the view with that conversation, enabling deep nested discussions.

**Animation Specification:**
- **Type:** CSS animation (NOT route change)
- **Transform:** Scale + position + z-index elevation
- **Backdrop:** Dimmed overlay behind zoomed card
- **Dismissal:** Click backdrop OR swipe back to return

**Expected Behavior:**
```
Thread View (Level 0)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Thread: "Octopuses - Ugly but amazing"                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Comment A                                     [2 replies] â”‚ â”‚ â† Click to zoom
â”‚ â”‚ "OK, let's see"                                          â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚ â”‚ â”‚ COUNTERPOINTS: [SIr, Sir!] [Another point]          â”‚  â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Comment B                                     [0 replies] â”‚ â”‚
â”‚ â”‚ "Different thought..."                                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

After clicking Comment A â†’ CSS zoom animation:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚
â”‚â–‘â–‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â–‘â–‘â”‚
â”‚â–‘â–‘â”‚ Comment A: "OK, let's see"                     [â–² 2 â–¼] â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚ â”‚ COUNTERPOINTS                                    â”‚   â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚ â”‚ â”‚ "SIr, Sir!"                       [1 reply] â”‚  â”‚   â”‚â–‘â–‘â”‚ â† Click to zoom deeper
â”‚â–‘â–‘â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚ â”‚ â”‚ "Another point"                   [0 reply] â”‚  â”‚   â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚                                                        â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚ Replies:                                               â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚ â”œâ”€ "First reply to this comment"                       â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚ â””â”€ "Second reply..."                                   â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚                                                        â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚ [Reply] [Add Counterpoint]                             â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â–‘â–‘â”‚
â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â–‘â–‘ = Dimmed backdrop (click to dismiss)
```

**Key Concept:** Each reply/counterpoint can generate its own nested thread. The UI lets you "dive deep" by zooming into any comment, then navigate back by:
- **Mobile:** Swipe back gesture
- **Desktop:** Click dimmed backdrop

**Depth Indicator â€” Stacked Cards:**
When zoomed multiple levels deep, show previous cards as a "fanned deck" â€” each parent card shows just a 1px border at the top edge, creating a visual breadcrumb of depth.

```
Zoomed 3 levels deep:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚
â”‚â–‘â–‘â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â–‘â–‘â”‚ â† Thread (Level 0)
â”‚â–‘â–‘â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â–‘â–‘â”‚ â† Comment A (Level 1)
â”‚â–‘â–‘â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â–‘â–‘â”‚ â† Counterpoint (Level 2)
â”‚â–‘â–‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â–‘â–‘â”‚
â”‚â–‘â–‘â”‚                                                        â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚  Current focused card (Level 3)                        â”‚â–‘â–‘â”‚ â† Fully visible
â”‚â–‘â–‘â”‚                                                        â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚  Reply to counterpoint: "Here's my response..."        â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚                                                        â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚  [Reply] [Add Counterpoint]                            â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â”‚                                                        â”‚â–‘â–‘â”‚
â”‚â–‘â–‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â–‘â–‘â”‚
â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†‘
   Click any parent card edge to zoom back to that level
```

**Requirements:**
- [ ] **Click-to-zoom** â€” Clicking a comment card triggers CSS animation
- [ ] **Scale + translate animation** â€” Card scales up and centers in viewport
- [ ] **Z-index elevation** â€” Zoomed card rises above other content
- [ ] **Dimmed backdrop** â€” Semi-transparent overlay behind zoomed card
- [ ] **Stacked card breadcrumb** â€” Parent cards show 1px top border (fanned deck effect)
- [ ] **Click parent edge to zoom back** â€” Clicking a parent card's visible edge returns to that level
- [ ] **Backdrop dismissal** â€” Click backdrop to return to thread root
- [ ] **Swipe back (mobile)** â€” Native gesture to return to parent level
- [ ] **Infinite nesting** â€” Each counterpoint/reply can have its own counterpoints/replies
- [ ] **No route change** â€” URL stays the same (state is visual only)

**Files to Modify:**
- `apps/web-pwa/src/components/hermes/ThreadView.tsx`
- `apps/web-pwa/src/components/hermes/CommentNode.tsx`
- `apps/web-pwa/src/components/hermes/CounterpointPanel.tsx`
- New: `ZoomableCard.tsx` wrapper component
- New: Navigation/gesture handling

---

### 2.4 [PLACEHOLDER: Additional forum refinements]

**Issue:** _To be filled in during testing_

**Requirements:**
- [ ] TBD

---

## 3. Messaging UI Refinements

### 3.1 Clean, Modern Messaging Layout

**Vision:** Standard messaging format â€” contacts left, conversation right, always accessible.

**Frictionless Contact Sharing Flow:**
```
Any Page â†’ Tap ğŸ’¬ in Navbar â†’ Tap ID Chip â†’ Share QR/Copy ID
```

**Expected Behavior:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜°  VENN / HERMES / AGORA                              ğŸŒ™  ğŸ‘¤ User  ğŸ’¬      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Contacts         â”‚  â”‚ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚  â”‚
â”‚  â”‚                  â”‚  â”‚ â•‘  [ğŸªª ID Chip]  Show QR â”‚ Copy ID           â•‘ â”‚  â”‚ â† FIXED
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚  â”‚   POSITION
â”‚  â”‚ â”‚ ğŸ‘¤ Alice     â”‚ â”‚  â”‚                                                â”‚  â”‚
â”‚  â”‚ â”‚ Last msg...  â”‚ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚                                         â”‚  â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”‚        Conversation Area                â”‚  â”‚  â”‚
â”‚  â”‚ â”‚ ğŸ‘¤ Bob       â”‚ â”‚  â”‚  â”‚        (scrollable)                     â”‚  â”‚  â”‚
â”‚  â”‚ â”‚ Hey there... â”‚ â”‚  â”‚  â”‚                                         â”‚  â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                  â”‚  â”‚                                                â”‚  â”‚
â”‚  â”‚                  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚                  â”‚  â”‚  â”‚ Type a message...              [Send]   â”‚  â”‚  â”‚
â”‚  â”‚                  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ID Chip Specification:**
- **Position:** Fixed at top of Messages view (always visible, even while scrolling)
- **Content:** Shows YOUR ID only (for sharing with others)
- **Actions:**
  - "Show QR" â€” Displays QR code modal
  - "Copy ID" â€” Copies ID to clipboard with confirmation toast

**Requirements:**
- [ ] **Contact list left panel** â€” Shows recent conversations, sorted by last message
- [ ] **Contact names** â€” Display user's **handle** (not raw nullifier) â€” see Â§3.2
- [ ] **Main conversation right panel** â€” Fills available space
- [ ] **ID Chip (fixed position)** â€” Always visible at top, doesn't scroll with messages
  - [ ] "Show QR" button
  - [ ] "Copy ID" button with clipboard + toast feedback
- [ ] **Most recent conversation persists** â€” On return to Messages, last active chat is visible
- [ ] **Responsive sizing** â€” Composer always visible without scrolling
- [ ] **Navbar message icon** â€” ğŸ’¬ icon in global nav, accessible from any page

**Files to Modify:**
- `apps/web-pwa/src/components/hermes/ChatLayout.tsx`
- `apps/web-pwa/src/components/hermes/ChannelList.tsx`
- `apps/web-pwa/src/components/hermes/Composer.tsx`
- `apps/web-pwa/src/components/hermes/ContactQR.tsx` â†’ Rename to `IDChip.tsx`
- `apps/web-pwa/src/components/layout/Navbar.tsx` (add messages icon)

---

### 3.2 User Handles (Display Names)

**Vision:** Users see friendly display names, not raw nullifiers.

**Handle Specification:**
- **Format:** Alphanumeric + underscores only (like Twitter)
- **Length:** 3-20 characters
- **Uniqueness:** NOT enforced globally â€” duplicates allowed
- **Discriminator:** If duplicates appear in same user's contact list, show discriminator (e.g., "Alice" and "Alice (2)")
- **When set:** During onboarding (required), can change in Settings anytime

**Current Behavior:**
- Contacts show as `dev-nullif...` (truncated nullifier)
- No way for users to set a custom name

**Expected Behavior:**
```
Onboarding Flow:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                          â”‚
â”‚   Choose your handle                     â”‚
â”‚                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ @___________________               â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   3-20 characters (letters, numbers, _)  â”‚
â”‚                                          â”‚
â”‚   [Continue]                             â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Contact List (with duplicate handling):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¤ Alice         â”‚  â† Only one Alice
â”‚ ğŸ‘¤ Bob           â”‚
â”‚ ğŸ‘¤ Charlie       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Contact List (with duplicates):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¤ Alice         â”‚  â† First Alice added
â”‚ ğŸ‘¤ Alice (2)     â”‚  â† Second Alice, discriminator added
â”‚ ğŸ‘¤ Bob           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Contact Exchange Data (updated):**
```json
{
  "nullifier": "dev-nullifier-abc123...",
  "epub": "abc123...",
  "handle": "Alice"
}
```

**Requirements:**
- [ ] **Handle field in identity** â€” Add `handle: string` to identity record
- [ ] **Onboarding step** â€” Required handle entry during first-time setup
- [ ] **Settings edit** â€” Can change handle anytime in Settings
- [ ] **Validation** â€” Alphanumeric + underscore, 3-20 chars
- [ ] **Contact exchange includes handle** â€” QR/copied data includes handle
- [ ] **Display handle in UI** â€” Channel list, message headers show handle
- [ ] **Discriminator for duplicates** â€” If same handle appears twice in contacts, append "(2)", "(3)", etc.
- [ ] **Fallback to truncated nullifier** â€” If no handle (legacy contacts), show `dev-nul...`

**Files to Modify:**
- `apps/web-pwa/src/hooks/useIdentity.ts` â€” Add handle to IdentityRecord
- `apps/web-pwa/src/routes/onboarding.tsx` â€” Handle entry step (new or update)
- `apps/web-pwa/src/routes/settings.tsx` â€” Handle edit UI
- `apps/web-pwa/src/components/hermes/IDChip.tsx` â€” Include handle in QR/copy data
- `apps/web-pwa/src/components/hermes/ChannelList.tsx` â€” Display handle + discriminator logic
- `apps/web-pwa/src/components/hermes/MessageBubble.tsx` â€” Display handle
- `packages/data-model/src/schemas/hermes/directory.ts` â€” Add handle to DirectoryEntry

---

### 3.3 [PLACEHOLDER: Additional messaging refinements]

**Issue:** _To be filled in during testing_

**Requirements:**
- [ ] TBD

---

## 4. General UI/UX Refinements

### 4.1 [PLACEHOLDER: Navigation, layout, visual issues]

**Issue:** _To be filled in during testing_

**Current Behavior:**

**Expected Behavior:**

**Requirements:**
- [ ] TBD

---

## 5. Accessibility Refinements

### 5.1 [PLACEHOLDER: A11y issues as discovered]

**Issue:** _To be filled in during testing_

**Requirements:**
- [ ] TBD

---

## 6. Performance Refinements

### 6.1 [PLACEHOLDER: Performance issues as discovered]

**Issue:** _To be filled in during testing_

**Requirements:**
- [ ] TBD

---

## 7. Implementation Priority

| ID | Issue | Component | Priority | Status |
|----|-------|-----------|----------|--------|
| 2.1 | Comment/Counterpoint duplication | Forum | HIGH | [ ] |
| 2.2 | VENN â†’ Forum 3D card flip transition | Forum/VENN | MEDIUM | [ ] |
| 2.3 | Nested comment zoom/focus (CSS + backdrop) | Forum | HIGH | [ ] |
| 3.1 | Clean messaging layout + fixed ID Chip | Messaging | HIGH | [ ] |
| 3.1a | Navbar messages icon (ğŸ’¬) | Global | MEDIUM | [ ] |
| 3.2 | User handles (display names) | Identity/Messaging | HIGH | [ ] |
| | | | | |

---

## 8. Testing Checklist

### 8.1 Forum Manual Tests
- [ ] Create thread with no replies â€” displays normally
- [ ] Add reply (not counterpoint) â€” displays in linear thread
- [ ] Add counterpoint â€” displays ONLY in card view, not duplicated
- [ ] Click comment card â€” zooms to fill view with CSS animation
- [ ] Dimmed backdrop appears behind zoomed card
- [ ] Click backdrop â€” returns to previous level
- [ ] Deep nesting â€” can zoom into counterpoint's replies
- [ ] **Stacked cards breadcrumb** â€” Parent cards show 1px border at top (fanned deck)
- [ ] **Click parent edge** â€” Returns to that level directly
- [ ] Vote on argument â€” updates score
- [ ] Vote on counterpoint pill â€” updates score
- [ ] Reply from zoomed view â€” works correctly
- [ ] Add counterpoint from zoomed view â€” appears as new pill

### 8.2 VENN â†’ Forum Transition Tests
- [ ] Click "Discuss in Forum" on article â€” 3D card flip animation
- [ ] Headline stays anchored at top during flip
- [ ] Summary/Bias section flips to reveal thread
- [ ] Navigate back to article â€” reverse flip animation
- [ ] **Empty thread state** â€” Shows "Start the conversation" prompt
- [ ] Can post first comment from empty state
- [ ] Direct link to thread works independently

### 8.3 Messaging Manual Tests
- [ ] Contact list shows on left panel
- [ ] Conversation shows on right panel
- [ ] ID Chip fixed at top (doesn't scroll with messages)
- [ ] "Show QR" displays QR code
- [ ] "Copy ID" copies to clipboard with toast feedback
- [ ] Composer always visible without scrolling
- [ ] Last conversation persists on return
- [ ] Messages icon (ğŸ’¬) in navbar opens Messages from any page

### 8.4 User Handle Tests
- [ ] **Onboarding requires handle** â€” Can't proceed without setting handle
- [ ] **Validation** â€” Rejects handles <3 or >20 chars
- [ ] **Validation** â€” Rejects handles with special chars (only alphanumeric + _)
- [ ] **Settings edit** â€” Can change handle in Settings
- [ ] Handle appears in contact exchange QR/copy data
- [ ] Contact list shows peer's handle (not nullifier)
- [ ] **Duplicate handling** â€” Second "Alice" shows as "Alice (2)"
- [ ] Message headers show peer's handle
- [ ] Missing handle (legacy) falls back to truncated nullifier

### 8.5 Regression Tests
- [ ] All existing E2E tests pass
- [ ] All unit tests pass
- [ ] Forum thread persistence still works
- [ ] Comment persistence still works
- [ ] Cross-browser sync still works
- [ ] Message send/receive still works
- [ ] Identity creation still works

---

## 9. Notes & Observations

_Space for notes during exploratory testing:_

### Session 1 (Dec 6, 2025)
- **Issue 2.1 identified:** Comment/Counterpoint duplication in ThreadView
- **Issue 2.2 identified:** Need smooth VENN â†’ Forum transition (card flip / swipe)
- **Issue 2.3 identified:** Nested comment zoom pattern â€” click to fill view, swipe/click to go back
- **Issue 3.1 identified:** Messaging layout refinement â€” contacts left, conversation right, ID Chip always visible
- **Issue 3.1a identified:** Messages icon in global navbar for quick access

### Session 1 - Clarifications (Dec 6, 2025)
- **2.3 Zoom:** CSS animation (scale/position/z-index), NOT route change. Dimmed backdrop for dismissal.
- **2.2 Flip:** 3D card flip, but ONLY summary/bias section flips â€” headline stays anchored at top
- **3.1 ID Chip:** Fixed position (always visible). Shows YOUR ID only. Frictionless: Nav â†’ Messages â†’ ID Chip
- **3.2 Handles:** Users need display names (handles). Contacts show handle, not nullifier.

### Session 1 - Additional Clarifications (Dec 6, 2025)
- **3.2 Handle format:** Alphanumeric + underscore, 3-20 chars (like Twitter)
- **3.2 Handle uniqueness:** NOT unique globally. Duplicates allowed. Show discriminator "(2)" only if same handle appears twice in one user's contact list.
- **3.2 When to set:** Required during onboarding, can change in Settings anytime.
- **2.3 Depth indicator:** Stacked cards â€” parent cards show 1px border at top edge (fanned deck). Can click parent edge to zoom back.
- **2.2 Empty thread:** Show "Start the conversation" prompt with inline composer.



---

## 10. Exit Criteria

- [ ] All identified issues resolved
- [ ] No visual regressions
- [ ] All tests passing
- [ ] Manual verification complete
- [ ] Ready for Sprint 4

